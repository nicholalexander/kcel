const BITS_PER_WORD=Math.log2(7776),WORD_LIST_SIZE=7776;function getSecureRandomNumber(e){if(e>4294967296)throw new Error("Max value too large for Uint32Array");const t=new Uint32Array(1),o=Math.floor(4294967296/e)*e;let n;do{crypto.getRandomValues(t),n=t[0]}while(n>=o);return n%e}function generatePassphrase(e){if(!EFF_WORDLIST||7776!==EFF_WORDLIST.length)throw new Error("Word list not loaded or corrupted");const t=[];for(let o=0;o<e;o++){const e=getSecureRandomNumber(7776);t.push(EFF_WORDLIST[e])}return t.join("-")}function calculateEntropy(e){return e*BITS_PER_WORD}function calculateCombinations(e){return Math.pow(7776,e)}function formatLargeNumber(e){return e<1e6?e.toLocaleString():e.toExponential(2)}function calculateCrackTime(e){const t=e/2e9,o=31557600,n=1e3*o,r=1e9*o,a=138e8*o;return t<60?`${t.toFixed(1)} seconds`:t<3600?`${(t/60).toFixed(1)} minutes`:t<86400?`${(t/3600).toFixed(1)} hours`:t<o?`${(t/86400).toFixed(1)} days`:t<n?`${(t/o).toFixed(1)} years`:t<r?`${(t/n).toFixed(1)} millennia`:t<a?`${(t/r).toFixed(1)} billion years`:`${(t/a).toFixed(1)} × age of universe`}async function copyToClipboard(e){try{return await navigator.clipboard.writeText(e),!0}catch(t){const o=document.createElement("textarea");o.value=e,o.style.position="fixed",o.style.opacity="0",document.body.appendChild(o),o.select();const n=document.execCommand("copy");return document.body.removeChild(o),n}}window.crypto&&window.crypto.getRandomValues||alert("Error: Your browser does not support the Web Crypto API. Please use a modern browser for secure passphrase generation."),document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("generate-btn"),t=document.getElementById("copy-btn"),o=document.getElementById("passphrase-display"),n=document.getElementById("passphrase");e.addEventListener("click",function(){try{const e=generatePassphrase(20);n.textContent=e,o.style.display="block",document.getElementById("copy-feedback").textContent=""}catch(e){alert("An error occurred while generating the passphrase. Please refresh the page and try again.")}}),t.addEventListener("click",async function(){const e=n.textContent,t=await copyToClipboard(e),o=document.getElementById("copy-feedback");t?(o.textContent=" ✓ Copied!",setTimeout(()=>{o.textContent=""},2e3)):alert("Failed to copy to clipboard. Please select and copy manually.")}),e.click()});